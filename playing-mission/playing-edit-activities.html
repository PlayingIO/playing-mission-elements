<link rel="import" href="../../playing-rule-elements/playing-rule/playing-edit-conditions.html">
<link rel="import" href="../../playing-rule-elements/playing-rule/playing-edit-rewardsets.html">
<link rel="import" href="../behaviors/playing-mission-behavior.html">

<!--
An element for creating and editing mission activities data.

Example:

    <playing-edit-activities rule=[[rule]] new></playing-edit-activities>

@group Playing Elements
@element playing-edit-activities
-->
<dom-module id="playing-edit-activities">
  <template>
    <style include="mostly-styles playing-styles">
      :host {
        display: block;
        margin-bottom: 25px;
      }

      iron-icon.remove {
        padding-top: 7px;
        width: 22px;
      }
    </style>

    <div class="layout vertical">
      <div class="layout horizontal center">
        <h3 class="flex">[[i18n('play.mission.activities')]]</h3>
        <paper-button noink id="addActivity" class="flex-end" on-tap="_addActivity">
          <iron-icon icon="mostly:add"></iron-icon> [[i18n('play.mission.activity.create')]]
        </paper-button>
      </div>

      <div class="table-header">
        <div class="flex-1">[[i18n('play.mission.activity.rewards')]]</div>
        <div class="flex-2">[[i18n('play.mission.activity.conditions')]]</div>
        <div class="form-actions">&nbsp;</div>
      </div>

      <template is="dom-repeat" items="{{data}}" as="activity">
        <div class="layout vertical" role="widget">
          <mostly-input name="name" label="[[i18n('play.mission.activity.name')]]"
                  value="{{activity.name}}" minlength="3" maxlength="20"
                  auto-validate required always-float-label></mostly-input>
          
          <mostly-input name="description" label="[[i18n('play.mission.activity.description')]]"
                  value="{{activity.description}}" maxlength="300"
                  char-counter always-float-label></mostly-input>
        </div>

        <div class="form-row border">
          <div class="flex-1">
            <!-- rewards -->
            <playing-edit-rewards data="{{activity.rewards}}"></playing-edit-rewards>
          </div>
          <div class="flex-2">
            <!-- conditions -->
            <playing-edit-conditions data="{{activity.requires}}"></playing-edit-conditions>
          </div>
          <div class="form-actions">
            <iron-icon icon="mostly:clear" class="remove"
                    data-index="[[index]]" on-tap="_removeActivity"></iron-icon>
          </div>
        </div>

      </template>

      <template is="dom-if" if=[[!data.length]]>
        <div class="form-row">
          <div class="empty-result">[[i18n('play.mission.activity.empty')]]</div>
        </div>
      </template>
    </div>

  </template>

  <script>
    class PlayingEditActivities extends Polymer.mixinBehaviors(
        [Mostly.I18nBehavior, Playing.MissionBehavior], Polymer.Element) {

      static get is() { return 'playing-edit-activities' };

      static get properties() {
        return {
          /**
           * The activities array.
           */
          data: {
            type: Array,
            value: [],
            notify: true
          }
        }
      }
    }

    customElements.define(PlayingEditActivities.is, PlayingEditActivities);
  </script>
</dom-module>